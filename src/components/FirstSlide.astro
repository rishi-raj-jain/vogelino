---
import { MappedNotionProject } from '../../scripts/lib/parseOriginalNotionProjects'
import classNames from '../utils/classNames'
import NotionFormattedRichText from './NotionFormattedRichText.astro'
import Link from './icons/Link.astro'
import * as astroComponents from 'astro-imagetools/components'

const { Img } = astroComponents

export interface Props {
	project: MappedNotionProject
}

const { project } = Astro.props
---

<li
	class:list={[
		`splide__slide relative`,
		`w-screen h-[calc(100svh-188px)] max-w-[1440px]`,
		`items-stretch !mt-20 mb-0 !md:my-20`,
		`gap-[8vw] justify-between`,
		`flex flex-col sm:flex-row`,
	]}
>
	<div
		class={classNames(
			`sm:basis-[180px] shrink-0 grow flex flex-col`,
			`items-start justify-start md:justify-center px-6`,
			`md:items-center py-4 sm:py-0`,
		)}
	>
		<div class={classNames('inline-flex flex-col items-start max-w-md')}>
			<span
				class={classNames(
					`sm:text-lg md:text-xl inline-block mb-3 sm:mb-3 md:mb-6`,
					`select-text`,
				)}>{project.year}</span
			>
			<h1
				class:list={[
					`text-5xl md:text-6xl 2xl:text-7xl`,
					`leading-[0.9em] sm:leading-[1em] text-balance`,
					`uppercase font-bold select-text`,
				]}
				set:html={project.title}
			/>
			<p
				class:list={[
					`text-balance select-text`,
					`text-lg sm:text-xl md:text-2xl lg:text-3xl mt-1 sm:mt-3 md:mt-4`,
				]}
			>
				<NotionFormattedRichText richText={project.description} />
			</p>

			{
				project.url && (
					<a
						href={project.url}
						target="_blank"
						class={classNames([
							`font-special antialiased`,
							`top-0 rounded-full bg-fg text-alt`,
							`hover-hover:hover:bg-alt hover-hover:hover:text-fg`,
							`transition-colors motion-reduce:transition-none`,
							`hover-hover:hover:scale-110`,
							`flex items-center`,
							`px-2 pb-0.5 md:px-4 md:pb-1 text-xl md:text-2xl`,
							`gap-1 md:gap-2`,
							`mt-2 sm:mt-4 md:mt-5`,
							`outline-none focus-visible:ring-2`,
							`focus-visible:ring-fg focus-visible:ring-offset-2`,
							`focus-visible:ring-offset-bg`,
						])}
					>
						<span>Launch</span> <Link className="mt-1" />
					</a>
				)
			}
		</div>
	</div>
	<div
		class={classNames(
			`w-full sm:max-w-[40%] lg:max-w-[50%] h-full relative`,
			`rounded-l-md border-alt`,
		)}
	>
		<div class={classNames(`absolute top-1/2 -translate-y-1/2 right-4`)}>
			<div
				class={classNames(`intro-slide-tilted-shadow absolute inset-0`)}
				aria-hidden="true"
			>
				<div
					class={classNames(
						`absolute inset-0 bg-gradient-to-t from-grayMed to-grayMed/0`,
						`dark:from-grayUltraDark dark:to-grayUltraDark/0`,
						`blur translate-y-[40px] translate-x-[48px]`,
					)}
				>
				</div>
			</div>
			<Img
				src={`/images/thumbnails/${project.slug}.webp`}
				alt={`Thumbnail for the project "${project.title}"`}
				layout="fixed"
				attributes={{
					img: {
						class: classNames(
							`max-h-[50vh] sm:max-h-[70vh] md:max-h-[80vh]`,
							`rounded !object-top`,
							`intro-slide-tilted-image`,
							`ring-1 ring-grayLight`,
							`dark:saturate-[1.1] dark:contrast-[1.1]`,
						),
					},
				}}
			/>
			<img
				src={`/images/illustrations/${project.slug}.svg`}
				alt={`Illustration for the project ${project.title}`}
				class={classNames(
					`max-h-[23vh] max-w-[260px] absolute bottom-0`,
					`sm:-left-12 lg:right-[16%]`,
					`pointer-events-none scale-50 xs:scale-75 sm:scale-100`,
					`origin-bottom-left`,
				)}
			/>
		</div>
	</div>
</li>

<style is:global>
	.intro-slide-tilted-image {
		transform: perspective(1735px) rotateX(27deg) rotateY(346deg) rotateZ(17deg)
			translateX(-6vw);
		transform-style: preserve-3d;
	}
	.intro-slide-tilted-shadow {
		transform: perspective(1524px) rotateX(48deg) rotateY(347deg) rotateZ(24deg)
			scaleX(0.95) translateX(-5vw);
		transform-style: preserve-3d;
	}
</style>
