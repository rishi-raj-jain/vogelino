---
import ProjectSliderSlide from '../components/ProjectSliderSlide.astro'
import Link from './icons/Link.astro'

const { project } = Astro.props

const highlightClasses = `bg-alt rounded-full pl-3 pr-2 mr-1 pt-2 pb-1 decoration-clone leading-relaxed`
---

<div
	class:list={[
		`splide h-[calc(100svh-16px)] w-screen overflow-x-hidden mx-auto`,
		`max-w-[1440px] min-[1440px]:border-x min-[1440px]:border-grayMed`,
	]}
	aria-label="List of project images"
>
	<div
		class:list={[
			`splide__track h-[calc(100svh-16px)] w-screen max-w-[1440px]`,
			`border-b-grayMed border-b bg-grayUltraLight relative`,
		]}
	>
		<ul class="splide__list w-screen h-[calc(100svh-16px)] max-w-[1440px]">
			<li
				class:list={[
					`splide__slide relative`,
					`w-screen h-[calc(100svh-188px)] px-6 max-w-[1440px]`,
					`items-center justify-center flex flex-col !mt-20 mb-0 !md:my-20`,
					`gap-6`,
				]}
			>
				<div class="flex flex-col text-center items-center justify-center">
					<span class="sm:text-lg md:text-xl block mb-2 sm:mb-3 md:mb-6"
						>{project.year}</span
					>
					<h1
						class:list={[
							`text-4xl sm:text-5xl md:text-6xl 2xl:text-7xl`,
							`leading-[1em] text-balance`,
							`uppercase font-bold`,
							`xs:max-w-[80%] sm:max-w-[70%] md:max-w-[60%] lg:max-w-[50%]`,
						]}
					>
						{project.title}
					</h1>
					<p
						class:list={[
							`text-balance`,
							`text-lg sm:text-xl md:text-2xl lg:text-3xl mt-2 sm:mt-3 md:mt-4`,
							`xs:max-w-[90%] sm:max-w-[80%] md:max-w-[70%] lg:max-w-[60%]`,
						]}
					>
						{
							project.description.map(
								(part) =>
									part.text &&
									(part.link ? (
										<a
											href={part.link}
											class={highlightClasses}
											target="_blank"
										>
											{part.text.trim()}
										</a>
									) : (
										<span class={part.highlighted ? highlightClasses : ''}>
											{part.text.trim()}
										</span>
									)),
							)
						}
					</p>
					{
						project.url && (
							<a
								href={project.url}
								target="_blank"
								class:list={[
									`font-special antialiased`,
									`top-0 rounded-full bg-fg text-alt`,
									`transition-colors hover:bg-alt hover:text-fg border-2 border-fg`,
									`hover:scale-110 special-button flex items-center`,
									`px-2 pb-0.5 md:px-4 md:pb-1 text-xl md:text-2xl`,
									`gap-1 md:gap-2`,
									`mt-3 sm:mt-4 md:mt-5 `,
								]}
							>
								<span>Launch</span> <Link className="mt-1" />
							</a>
						)
					}
				</div>
				<img
					src={`/images/illustrations/${project.slug}.svg`}
					alt={`Illustration for the project ${project.title}`}
					class:list={[
						`max-h-[25vh] max-w-[260px] md:absolute -bottom-24 `,
						`right-[8%] lg:right-[16%]`,
						`pointer-events-none`,
					]}
				/>
			</li>
			{
				project.media.map((i) => (
					<ProjectSliderSlide projectName={project.title} imageUrl={i} />
				))
			}
		</ul>
	</div>
</div>

<script>
	import Splide from '@splidejs/splide'

	const slider = new Splide('.splide', {
		rewind: true,
		arrows: false,
		pagination: true,
		paginationKeyboard: true,
	})

	slider.mount()

	const nextButton = document.getElementById('project-next')
	const prevButton = document.getElementById('project-prev')

	nextButton.addEventListener('click', (evt) => {
		evt.preventDefault()
		slider.go('>')
	})
	prevButton.addEventListener('click', (evt) => {
		evt.preventDefault()
		slider.go('<')
	})
</script>

<style is:global>
	.splide__img {
		@apply rounded max-w-[calc(100svw-48px)] max-h-[calc(100svh-154px)];
	}
	.splide__pagination {
		@apply absolute left-1/2 opacity-0 sm:opacity-100 bottom-7 gap-3 -translate-x-1/2;
	}

	.splide__pagination li {
		@apply w-3 h-3;
	}

	button.splide__pagination__page {
		@apply w-3 h-3 rounded-full bg-grayMed transition-colors;
	}

	button.splide__pagination__page[aria-selected='true'] {
		@apply bg-fg;
	}
</style>
